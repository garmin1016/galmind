<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>ã‚®ãƒ£ãƒ«ãƒã‚¤ãƒ³ãƒ‰è¨ºæ–­ï½œ10æ®µéšãƒ»100ç‚¹æº€ç‚¹</title>
  <meta name="description" content="ã‚®ãƒ£ãƒ«Ã—ãƒ“ã‚¸ãƒã‚¹ã®æ˜ã‚‹ã„è¨ºæ–­UIğŸŒˆ 19å•ã«ç­”ãˆã‚‹ã ã‘ã€‚Q1-18ã¯5æ®µéšã®ãƒãƒ¼ãƒˆã€Q19ã¯10æ®µéšã§100ç‚¹æº€ç‚¹ï¼†10æ®µéšãƒ¬ãƒ™ãƒ«ï¼">
  <meta property="og:title" content="ã‚®ãƒ£ãƒ«ãƒã‚¤ãƒ³ãƒ‰è¨ºæ–­"/>
  <meta property="og:description" content="1å•ãšã¤å¯æ„›ãå›ç­”â†’ãƒ¬ãƒ™ãƒ«ç”»åƒã¨ã‚®ãƒ£ãƒ«èªMAXã‚³ãƒ¡ãƒ³ãƒˆãŒå‡ºã‚‹ã‚ˆğŸ’–"/>
  <meta property="og:type" content="website"/>
  <meta property="og:image" content="./assets/og_default.png"/>
  <meta name="theme-color" content="#ff8adf"/>
  <style>
    /* ====== Theme: ç™½Ã—ãƒ”ãƒ³ã‚¯Ã—ãƒ‘ãƒ¼ãƒ—ãƒ«ï¼ˆæ˜ã‚‹ã„ã‚®ãƒ£ãƒ«ï¼‰ ====== */
    :root{
      --bg:#fff7fd;            /* è–„ã„ãƒ”ãƒ³ã‚¯èƒŒæ™¯ */
      --card:#ffffff;          /* çœŸã£ç™½ã‚«ãƒ¼ãƒ‰ */
      --ink:#3a2a33;           /* ã“ã’èŒ¶ãŒã‹ã£ãŸæ¿ƒã‚°ãƒ¬ãƒ¼ï¼ˆé»’ã‚ˆã‚ŠæŸ”ã‚‰ã‹ã„ï¼‰*/
      --muted:#7b5b6a;         /* è£œåŠ©ãƒ†ã‚­ã‚¹ãƒˆ */
      --pink:#ff6fbf;          /* ãƒ¡ã‚¤ãƒ³ãƒ”ãƒ³ã‚¯ */
      --pinka:#ff97d7;         /* ã‚¢ã‚¯ã‚»ãƒ³ãƒˆãƒ”ãƒ³ã‚¯ */
      --purple:#9b5bff;        /* ãƒ‘ãƒ¼ãƒ—ãƒ« */
      --sky:#9cf1ff;
      --radius:22px;
    }
    *{box-sizing:border-box}
    html,body{margin:0;height:100%;}
    body{
      background:
        radial-gradient(1200px 600px at 10% -10%, rgba(255,221,244,.8), transparent 60%),
        radial-gradient(1000px 700px at 110% -20%, rgba(201,179,255,.55), transparent 55%),
        var(--bg);
      color:var(--ink);
      font:16px/1.65 "Noto Sans JP", system-ui, -apple-system, Segoe UI, Roboto, "Hiragino Sans", "Yu Gothic UI", "Yu Gothic", sans-serif;
      letter-spacing:.01em;
    }
    a{color:var(--purple);text-decoration:none}
    .wrap{max-width:960px;margin:0 auto;padding:24px;}
    .app{background:linear-gradient(180deg,rgba(255,255,255,.9),rgba(255,255,255,.96));border:2px solid #ffe0f1;border-radius:var(--radius);box-shadow:0 20px 50px rgba(255,110,190,.15);overflow:hidden}
    header{padding:22px 20px 8px;border-bottom:1px dashed #ffd0eb;background:
      linear-gradient(180deg, rgba(255,255,255,.85), rgba(255,255,255,1));}
    .logo{display:flex;align-items:center;gap:10px}
    .logo-badge{background:linear-gradient(90deg,#ffd4f0,#fce7ff,#eae3ff);border:1px solid #ffc5ea;color:#7a4667;padding:6px 10px;border-radius:999px;font-weight:800;font-size:12px;box-shadow:0 6px 20px rgba(255,160,220,.25)}
    h1{margin:6px 0 4px;font-size:26px; font-weight:900; letter-spacing:.02em}
    .lead{color:var(--muted);margin:0 0 10px}

    .section{padding:16px 20px 22px}
    .card{background:var(--card);border:2px solid #ffe9f7;border-radius:var(--radius);box-shadow:0 12px 30px rgba(255,110,190,.12);padding:16px}
    .grid-2{display:grid;gap:14px}
    @media(min-width:800px){.grid-2{grid-template-columns:1fr 1fr}}

    label.f{display:flex;flex-direction:column;gap:6px}
    label.f span{font-size:13px;color:#7a5870}
    input[type="text"], input[type="email"], select{padding:12px 14px;border-radius:14px;border:1.6px solid #ffd0eb;background:#fff;outline:none;color:var(--ink)}
    input:focus, select:focus{box-shadow:0 0 0 4px rgba(255,149,215,.25)}

    /* Progress */
    .progress{display:flex;align-items:center;gap:10px;margin:6px 0 0}
    .bar{flex:1;height:10px;background:#ffe3f3;border-radius:999px;overflow:hidden;border:1px solid #ffd0eb}
    .bar > i{display:block;height:100%;width:0;background:linear-gradient(90deg,var(--pinka),var(--purple));transition:width .35s ease}
    .step{font-size:12px;color:#7a5870}

    /* Q flow */
    .qwrap{padding:6px 0}
    .qcard{background:var(--card);border:2px solid #fbd4f0;border-radius:22px; box-shadow:0 10px 24px rgba(155,91,255,.12);padding:18px}
    .qhead{display:flex;align-items:center;gap:10px;margin-bottom:6px}
    .chip{display:inline-flex;align-items:center;gap:6px;background:#fff; border:1.6px solid #ffd0eb; padding:6px 10px;border-radius:999px;font-size:12px;color:#7a5870}
    .qtext{font-size:18px;font-weight:800;margin:4px 0 10px}

    /* Heart rating */
    .hearts{display:flex;gap:8px;flex-wrap:wrap}
    .heart{width:42px;height:42px;border-radius:12px;display:grid;place-items:center;cursor:pointer;border:1.6px solid #ffd0eb;background:#fff;transition:transform .08s ease, box-shadow .2s}
    .heart[data-active="true"], .heart:hover{box-shadow:0 8px 20px rgba(255,110,190,.27); transform:translateY(-1px);background:linear-gradient(180deg,#fff,#fff0f7)}
    .heart span{font-size:22px}

    .actions{display:flex;gap:10px;flex-wrap:wrap;margin-top:12px}
    .btn{background:linear-gradient(90deg, var(--pinka), var(--purple)); color:#fff; border:none; padding:12px 16px; border-radius:14px; font-weight:900; letter-spacing:.03em; cursor:pointer; box-shadow:0 10px 24px rgba(155,91,255,.26)}
    .btn.subtle{background:#fff;color:#7a5870;border:2px solid #ffd0eb;box-shadow:none}

    /* Result */
    .result{display:none}
    .result.active{display:block}
    .rgrid{display:grid;gap:16px}
    @media(min-width:880px){.rgrid{grid-template-columns:220px 1fr}}
    .rimg{border-radius:18px;border:2px solid #ffd0eb;background:#fff;overflow:hidden}
    .badge{display:inline-block;background:#fff;border:2px solid #ffd0eb;border-radius:999px;padding:6px 10px;font-size:12px;color:#7a5870;margin-right:8px}
    .rg{margin-top:8px}
    .comment{background:linear-gradient(180deg,#fff,#fff5fb);border:2px solid #ffd0eb;border-radius:18px;padding:12px}
    .muted{color:#7a5870}
    footer{text-align:center;color:#8a6a7a;opacity:.85;padding:18px}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="app">
      <header>
        <div class="logo">
          <span class="logo-badge">ã‚®ãƒ£ãƒ«å¼Â®ï¸</span>
        </div>
        <h1>ã‚®ãƒ£ãƒ«ãƒã‚¤ãƒ³ãƒ‰è¨ºæ–­ ğŸŒˆğŸ’–ï¼ˆ10æ®µéšãƒ»100ç‚¹æº€ç‚¹ï¼‰</h1>
        <p class="lead">1å•ãšã¤ã€ãƒãƒ¼ãƒˆã§ã‚µã‚¯ã‚µã‚¯ç­”ãˆã¦ã­ğŸ’… Q1-18ã¯<mark>ğŸ’—Ã—5æ®µéš</mark>ã€Q19ã¯<mark>ğŸ’—Ã—10æ®µéš</mark>ã ã‚ˆï¼</p>
        <div class="progress"><div class="bar"><i id="bar"></i></div><div class="step"><span id="stepNow">0</span>/<span id="stepMax">19</span></div></div>
      </header>

      <!-- åŸºæœ¬æƒ…å ± -->
      <section class="section">
        <div class="card">
          <h2 style="margin:0 0 10px; font-weight:900">ã¾ãšã¯åŸºæœ¬æƒ…å ±æ•™ãˆã¦ã€œğŸ’–</h2>
          <div class="grid-2">
            <label class="f">ãŠåå‰<span>ãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ ã§ã‚‚OK</span>
              <input id="f_name" type="text" placeholder="ä¾‹ï¼‰ã‚®ãƒ£ãƒ«å­" required>
            </label>
            <label class="f">ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹<span>çµæœã®å…±æœ‰ã‚„é›†è¨ˆç”¨</span>
              <input id="f_email" type="email" placeholder="example@company.jp" required>
            </label>
            <label class="f">æ‰€å±ï¼ˆä¼šç¤¾ãƒ»éƒ¨ç½²ãªã©ï¼‰
              <input id="f_org" type="text" placeholder="ä¾‹ï¼‰CGOãƒ‰ãƒƒãƒˆã‚³ãƒ  / ä¼ç”»éƒ¨">
            </label>
            <label class="f">å½¹è·
              <input id="f_title" type="text" placeholder="ä¾‹ï¼‰ãƒ‡ã‚£ãƒ¬ã‚¯ã‚¿ãƒ¼">
            </label>
            <label class="f">æ€§åˆ¥
              <select id="f_gender">
                <option value="">é¸æŠã—ãªã„</option>
                <option>å¥³æ€§</option>
                <option>ç”·æ€§</option>
                <option>ãƒãƒ³ãƒã‚¤ãƒŠãƒªãƒ¼/ä»–</option>
              </select>
            </label>
            <label class="f">å¹´é½¢
              <input id="f_age" type="text" inputmode="numeric" placeholder="ä¾‹ï¼‰24">
            </label>
          </div>
          <div class="actions"><button id="start" class="btn" type="button">è¨ºæ–­ã‚¹ã‚¿ãƒ¼ãƒˆğŸ’–</button></div>
        </div>
      </section>

      <!-- è³ªå•ãƒ•ãƒ­ãƒ¼ -->
      <section class="section">
        <div id="qwrap" class="qwrap" aria-live="polite"></div>
        <div class="actions" id="nav" style="display:none">
          <button id="prev" class="btn subtle" type="button">æˆ»ã‚‹</button>
          <button id="next" class="btn" type="button">æ¬¡ã¸ğŸ’…</button>
        </div>
      </section>

      <!-- çµæœ -->
      <section class="section result" id="result">
        <div class="rgrid">
          <div class="rimg"><img id="resultImg" alt="çµæœç”»åƒ" style="width:100%; display:block"></div>
          <div>
            <h2 style="margin:0 0 8px; font-weight:900">è¨ºæ–­çµæœã§ãŸã‚ˆã€œã€œã€œï¼ğŸ’–</h2>
            <div class="rg">
              <span class="badge" id="badgeLevel">Lv?</span>
              <span class="badge" id="badgeScore">? / 100</span>
            </div>
            <p class="comment" id="commentGal">ã‚³ãƒ¡ãƒ³ãƒˆï¼ˆã‚®ãƒ£ãƒ«ï¼‰</p>
            <p class="muted" id="commentBiz" style="margin-top:8px"></p>
            <div class="actions" style="margin-top:10px">
              <button id="copyLink" class="btn subtle" type="button">çµæœãƒªãƒ³ã‚¯ã‚’ã‚³ãƒ”ãƒ¼</button>
              <a id="tweet" class="btn" target="_blank" rel="noopener">Xã§è‡ªæ…¢ã™ã‚‹ğŸŒˆ</a>
            </div>
            <p class="muted" style="font-size:12px;margin-top:8px">ç”»åƒã¯ <code>./assets/img_lv{1..10}.png</code> ã‚’ç”¨æ„ã—ã¦ã­ã€‚</p>
          </div>
        </div>
      </section>

      <footer>Â© CGOãƒ‰ãƒƒãƒˆã‚³ãƒ ï½œã‚®ãƒ£ãƒ«å¼Â®ï¸</footer>
    </div>
  </div>

  <script>
    // ====== è¨­å®š ======
    const GAS_URL = 'YOUR_GOOGLE_APPS_SCRIPT_WEB_APP_URL'; // ä»»æ„: å›ç­”ä¿å­˜

    // è³ªå•æ–‡ï¼šQ1-18 = 5æ®µéšï¼ˆğŸ’—Ã—5ï¼‰ã€Q19 = 10æ®µéšï¼ˆğŸ’—Ã—10ï¼‰
    const QUESTIONS = [
      'ä¼šç¤¾ã®ä¸­ã§ã€Œã‚„ã£ã¦ã¿ãŸã„ğŸ’ã€ã¨æ€ã†ã“ã¨ãŒã‚ã‚‹ï½ï½ï½ï¼Ÿ',
      'ä»Šã‚„ã£ã¦ã„ã‚‹ä»•äº‹ã‚¹ã‚­ï¼Ÿâ˜…',
      'ä»Šã‚ˆã‚Šã‚‚ã£ã¨ğŸ‘†ã‚¢ã‚²ğŸ‘†ã«ãªã‚ŠãŸã„ï¼Ÿ',
      'ã€Œç§ãŒã‚„ã‚ŠãŸã„ä»•äº‹ã¯ã“ã‚Œãƒ€ãƒ¨â•ã€ã£ã¦è¨€ãˆã‚‹ï¼Ÿ',
      'ç¤¾å†…ã§ã€Œã“ã®äººã®è©±èã„ã¦ã¿ãŸã„â˜ºã€ã£ã¦æ€ã£ãŸã¨ãã«ã€ã™ãã«é€£çµ¡ã§ãã‚‹âœ‰ï¼Ÿ',
      'è‡ªåˆ†æœ€é«˜ã‚¸ãƒ£ãƒ³ï½â™¥ã£ã¦æ€ã†ï¼Ÿ',
      'ç¤¾å†…é£²ã¿ä¼šï¼ˆé£Ÿäº‹ä¼šï¼‰ã§ã€å‘¨ã‚Šã«åˆã‚ã›ãšã€è‡ªåˆ†ãŒå¥½ããªé£Ÿã¹ç‰©/é£²ã¿ç‰©ğŸ¥ƒã‚’é ¼ã‚ã‚‹ï¼Ÿ',
      'ã‚¹ãƒ†ã‚­ãªæ„è¦‹ã‚’è¨€ã£ãŸäººã«ã€Œã„ã„ã˜ã‚ƒã‚“ï½ğŸµã€ã£ã¦è¨€ãˆã‚‹ï¼Ÿ',
      'å¤šå°‘ç„¡ç†ãªã“ã¨ã§ã‚‚ã€Œã‚¦ãƒã‚‰ãªã‚‰ã§ãã‚‹ã£ã—ã‚‡ğŸ’ªã€ã£ã¦æ€ãˆã‚‹ï¼Ÿ',
      'è‡ªåˆ†ã‚ˆã‚Šã‚¨ãƒ©ã‚¤äººã«ã‚‚ã€è‡ªä¿¡ã‚’ã‚‚ã£ã¦æ„è¦‹ãŒè¨€ãˆã‚‹âœ¨ï¼Ÿ',
      'è‡ªåˆ†ã‚‰ã—ã„æœã‚„æŒã¡ç‰©ğŸ‘—ã‚’ä¼šç¤¾ã§ã‚‚èº«ã«ç€ã‘ã¦ã„ã‚‹ï¼Ÿ',
      'å¤šå°‘å‡¹ã‚“ã§ã‚‚ã€Œé€™ã„ä¸ŠãŒã‚‹ãğŸ’ªã€ã¨åŠ›ãŒæ¹§ã„ã¦ãã‚‹ï½ï¼Ÿ',
      'è‡ªåˆ†ã¨é•ã†æ„è¦‹ãŒå‡ºãŸã¨ãã€Œãã‚Œã¡ãŒããªã„ï½ï¼ŸğŸ’¦ã€ã£ã¦è¨€ãˆã‚‹ï¼Ÿ',
      'ã„ã‚„ãªã“ã¨ã«ã¯ã™ã‹ã•ãšã€ŒNOâ•â•â•ã€ã£ã¦è¨€ãˆã‚‹ï¼Ÿ',
      'è‡ªåˆ†ã¯ãªã«ã‹æˆã—é‚ã’ã‚‰ã‚Œã¡ã‚ƒã†ã‹ã‚‚ğŸŒã¨æ€ã£ã¦ã‚‹ï½ï¼Ÿ',
      'è‡ªåˆ†ã®ã€Œã“ã‚Œã ã‘ã¯è­²ã‚Œãªã„ãƒƒâ£ã€ã£ã¦ãƒ¢ãƒ/ã‚³ãƒˆã£ã¦ã‚ã‚‹ï½ï¼Ÿ',
      'è€ƒãˆã‚‹ã‚ˆã‚Šä½“å‹•ã„ã¡ã‚ƒã†ï½ï½ï½ï½ï½ï¼ŸğŸ’ƒ',
      'è‡ªåˆ†ã®ã‚¹ã‚­ğŸ’ãªã¨ã“ã‚ï¼“ã¤ä»¥ä¸Šã„ãˆã‚‹ï½ï¼Ÿ',
      'è‡ªåˆ†ã®å¿ƒã«ã¯ã€Œè‡ªåˆ†è»¸ãƒ»ç›´æ„Ÿæ€§ãƒ»ãƒã‚¸ãƒ†ã‚£ãƒ–æ€è€ƒã€ãŒã‚ã‚‹ï½ï½ï½ï¼Ÿ' // Q19ï¼ˆ10æ®µéšï¼‰
    ];

    const stepMax = QUESTIONS.length; // 19
    document.getElementById('stepMax').textContent = stepMax;
    const qwrap = document.getElementById('qwrap');
    const bar = document.getElementById('bar');
    const stepNow = document.getElementById('stepNow');

    let idx = -1; // -1=ã¾ã å§‹ã¾ã£ã¦ãªã„
    const answers = {};// {1:1..5, ..., 19:1..10}

    // ====== UI: ãƒãƒ¼ãƒˆç¾¤ã®ç”Ÿæˆ ======
    function makeHearts(n, current){
      const box = document.createElement('div');
      box.className = 'hearts';
      for(let i=1;i<=n;i++){
        const b = document.createElement('button');
        b.type = 'button';
        b.className = 'heart';
        b.dataset.val = String(i);
        b.dataset.active = current && i<=current ? 'true':'false';
        const span = document.createElement('span');
        span.textContent = 'ğŸ’—';
        b.appendChild(span);
        b.onclick = ()=>{
          box.querySelectorAll('.heart').forEach((el)=>{
            el.dataset.active = Number(el.dataset.val) <= i ? 'true':'false';
          });
          box.dataset.value = String(i);
        };
        box.appendChild(b);
      }
      if(current){ box.dataset.value = String(current); }
      return box;
    }

    // ====== è³ªå•ã®æç”» ======
    function renderQuestion(){
      qwrap.innerHTML = '';
      const n = idx+1; // 1-based
      stepNow.textContent = n;
      const pct = Math.round((n-1)/stepMax*100);
      bar.style.width = pct + '%';

      const card = document.createElement('div');
      card.className = 'qcard';

      const head = document.createElement('div');
      head.className = 'qhead';
      head.innerHTML = `<span class="chip">Q${n}</span>`;

      const text = document.createElement('div');
      text.className = 'qtext';
      text.textContent = QUESTIONS[idx];

      const heartsNum = (n === 19) ? 10 : 5;
      const current = answers[n] ? Number(answers[n]) : 0;
      const hearts = makeHearts(heartsNum, current);
      hearts.id = 'hearts';

      card.appendChild(head); card.appendChild(text); card.appendChild(hearts);
      qwrap.appendChild(card);

      document.getElementById('nav').style.display = 'flex';
      document.getElementById('prev').disabled = (n===1);
      document.getElementById('next').textContent = (n===stepMax? 'çµæœã‚’è¦‹ã‚‹âœ¨':'æ¬¡ã¸ğŸ’…');
    }

    function saveCurrent(){
      const n = idx+1;
      const hearts = document.getElementById('hearts');
      const v = Number(hearts?.dataset.value || 0);
      const needed = (n===19)?10:5;
      if(!v || v<1 || v>needed){
        alert(`Q${n} ã®ãƒãƒ¼ãƒˆã‚’é¸ã‚“ã§ã­ğŸ’—`);
        return false;
      }
      answers[n] = v;
      return true;
    }

    function calcScore(){
      let total = 0;
      for(let i=1;i<=19;i++){
        const v = Number(answers[i]||0);
        if(i===19){ total += v; /* 10æ®µéš -> ãã®ã¾ã¾ */ }
        else{ total += v; /* 5æ®µéš */ }
      }
      // Q1-18ã¯æœ€å¤§ 90, Q19ã¯æœ€å¤§ 10 â†’ åˆè¨ˆ100
      return total;
    }

    function scoreToLevel(score){
      if(score <= 29) return 1;
      if(score <= 39) return 2;
      if(score <= 49) return 3;
      if(score <= 59) return 4;
      if(score <= 69) return 5;
      if(score <= 79) return 6;
      if(score <= 84) return 7;
      if(score <= 89) return 8;
      if(score <= 94) return 9;
      return 10; // 95-100
    }

    const GAL_COMMENTS = {
      1:'ã¾ã çœ ã£ã¦ã‚‹ã ã‘ï¼ã¾ãšã¯å°ã•ã1ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã§OKğŸ’• ä»Šæ—¥ãªã«ã‚¢ã‚²ã‚Œã‚‹ï¼Ÿ',
      2:'ã˜ã‚ã˜ã‚èŠ½ç”Ÿãˆä¸­ã€œï¼è¤’ã‚è¨€è‘‰ã¯è‡ªåˆ†ã«ã‚‚é…ã£ã¦ã“ğŸ’–',
      3:'ãã¦ã‚‹ãã¦ã‚‹ï¼ãã®ãƒãƒªã«+1ã®å‹‡æ°—ã‚’è¶³ã—ãŸã‚‰ä¸€æ°—ã«æ™¯è‰²å¤‰ã‚ã‚‹ğŸ”¥',
      4:'åœŸå°å®Œæˆï¼å‘¨ã‚Šã®ç©ºæ°—ã‚ˆã‚Šè‡ªåˆ†ã®ç›´æ„Ÿå„ªå…ˆã§ã„ã“ğŸ’…',
      5:'å®‰å®šã—ã¦ã‚¢ã‚²â†‘ 1æ—¥1ã‚®ãƒ£ãƒ«è¡Œå‹•ã§ã‚‚ã£ã¨æ³¢ã‚’ä½œã‚ğŸŒˆ',
      6:'ã„ã„æ„Ÿã˜ã®è‡ªèµ°æ„Ÿï¼æ¨ã—Ã—ä»•äº‹ã§éŠã³å¿ƒã­ã˜è¾¼ã‚‚ğŸ’–',
      7:'å·»ãè¾¼ã¿ã¯ã˜ã‚ãŸï¼ãƒŠã‚¤ã‚¹ã€œï¼ã€Œä¸€ç·’ã«ã‚„ã‚ã€å£ç™–ã«ã—ã¦ã“âœ¨',
      8:'ä¸Šä½ã‚®ãƒ£ãƒ«ï¼NOã¨è¨€ãˆã‚‹å‹‡æ°—ãŒå®ˆã£ã¦ãã‚Œã‚‹ã€‚å¥½ãã§ä¸–ç•Œã‚’å¡—ã‚Šæ›¿ãˆã‚ˆğŸ’˜',
      9:'ãƒ—ãƒ¬ãƒŸã‚¢é ˜åŸŸï¼ãã®ãƒã‚¤ãƒ–ã‚¹ã€ç¤¾å†…ã®ç¯å°ã€‚æ¬¡ã¯å¾Œè¼©ã®ã‚¢ã‚²ä¿‚ãŠé¡˜ã„ğŸ’«',
      10:'ç¥åŸŸğŸ’– ã‚‚ã†ã‚ãªãŸãŒæ–‡åŒ–ã€‚é æ…®ã›ãšæ——ã‚’æŒ¯ã£ã¦ã“ã€œã€œã€œï¼ğŸ”¥'
    };
    const BIZ_COMMENTS = {
      1:'æœ€å°ä¸€æ­©ï¼šä»Šæ—¥ã®ä¼šè­°ã§1å›ã ã‘ã€Œç§ã¯ã€œã¨æ€ã„ã¾ã™ã€ã‚’è¨€ã†ã€‚',
      2:'ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯è¨­è¨ˆï¼š1æ—¥1å›ã€åŒåƒšã‚’å…·ä½“çš„ã«è¤’ã‚ã‚‹ï¼ˆäº‹å®Ÿâ†’æ„Ÿè¬ï¼‰ã€‚',
      3:'æ™‚é–“æŠ•è³‡ï¼šé€±30åˆ†ã€Œè‡ªåˆ†ã®æ¨ã—Ã—æ¥­å‹™ã€æ£šå¸ã—ã€‚æ¥­å‹™ã«1ã¤ã ã‘æ··ãœã‚‹ã€‚',
      4:'æ„æ€è¡¨ç¤ºï¼šã‚„ã‚ŠãŸã„æ¥­å‹™ã‚’ä¸Šé•·ã«å®£è¨€ï¼ˆæ–‡é¢ã§OKï¼‰ã€‚',
      5:'NOåŸºæº–ï¼šã‚„ã‚‰ãªã„æ¡ä»¶ã‚’3ã¤è¨€èªåŒ–â†’ä¼šè­°å‰ã«å…±æœ‰ã€‚',
      6:'å·»ãè¾¼ã¿ï¼šå°ã•ãªPoCã‚’ææ¡ˆâ†’2åã‚’æŒ‡åã—ã¦å·»ãè¾¼ã‚€ã€‚',
      7:'ä»•çµ„ã¿åŒ–ï¼šæˆåŠŸãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ãƒ†ãƒ³ãƒ—ãƒ¬åŒ–â†’ãƒãƒ¼ãƒ ã«é…å¸ƒã€‚',
      8:'æ¨©é™è¨­è¨ˆï¼šæ±ºè£è€…ã‚’å…ˆã«æ¡ã‚‹â†’é€†ç®—ã§è¨ˆç”»ã‚’å¼•ãã€‚',
      9:'å¾Œç¶™è‚²æˆï¼šãƒŸãƒ‹1on1ã‚’æ¯é€±15åˆ†ã€3åã«è¡Œã†ã€‚',
      10:'æ–‡åŒ–åŒ–ï¼šè¡Œå‹•è¦ç¯„ã‚’çŸ­æ–‡åŒ–â†’æœä¼šã§1ãƒ•ãƒ¬ãƒ¼ã‚ºå®£è¨€ã‚’é‹ç”¨ã€‚'
    };

    function showResult(){
      const score = calcScore();
      const level = scoreToLevel(score);
      document.getElementById('badgeLevel').textContent = `Lv${level}`;
      document.getElementById('badgeScore').textContent = `${score} / 100`;
      document.getElementById('resultImg').src = `./assets/img_lv${level}.png`;
      document.getElementById('commentGal').textContent = GAL_COMMENTS[level] || '';
      document.getElementById('commentBiz').textContent = BIZ_COMMENTS[level] || '';

      const payload = btoa(JSON.stringify({s:score,l:level,n:document.getElementById('f_name').value||''}));
      const link = new URL(location.href.split('#')[0]);
      link.searchParams.set('r', payload);
      document.getElementById('copyLink').onclick = async ()=>{
        try{ await navigator.clipboard.writeText(link.toString()); alert('ãƒªãƒ³ã‚¯ã‚’ã‚³ãƒ”ãƒ¼ã—ãŸã‚ˆğŸ’–'); }catch(e){ alert('ã‚³ãƒ”ãƒ¼ã§ããªã‹ã£ãŸğŸ¥² URLã‚’æ‰‹ã§é¸æŠã—ã¦ã­'); }
      };
      document.getElementById('tweet').href = `https://twitter.com/intent/tweet?text=${encodeURIComponent('ã€ã‚®ãƒ£ãƒ«ãƒã‚¤ãƒ³ãƒ‰è¨ºæ–­ã€‘ã‚ãŸã—ã®çµæœã§ãŸğŸ’–')}&url=${encodeURIComponent(link.toString())}`;

      // ç«¯æœ«ä¿å­˜
      localStorage.setItem('galmind:last', JSON.stringify({score,level,ts:Date.now()}));

      // ãƒ­ã‚°é€ä¿¡ï¼ˆä»»æ„/GASï¼‰
      sendLog({score,level});

      document.getElementById('result').classList.add('active');
      document.getElementById('result').scrollIntoView({behavior:'smooth'});
    }

    async function sendLog(model){
      if(!GAS_URL || GAS_URL.startsWith('YOUR_')) return;
      try{
        const payload = {
          event:'submit',
          result:model,
          profile:{
            name:document.getElementById('f_name').value||'',
            email:document.getElementById('f_email').value||'',
            org:document.getElementById('f_org').value||'',
            title:document.getElementById('f_title').value||'',
            gender:document.getElementById('f_gender').value||'',
            age:document.getElementById('f_age').value||''
          },
          meta:{href:location.href,ref:document.referrer,ua:navigator.userAgent}
        };
        await fetch(GAS_URL,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(payload)});
      }catch(e){ console.warn('log failed', e); }
    }

    // ====== ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ ======
    document.getElementById('start').onclick = ()=>{
      // å¿…é ˆï¼šåå‰ï¼†ãƒ¡ãƒ¼ãƒ«
      const name = document.getElementById('f_name').value.trim();
      const email = document.getElementById('f_email').value.trim();
      if(!name || !email){ alert('ãŠåå‰ã¨ãƒ¡ãƒ¼ãƒ«ã ã‘å…¥ã‚Œã¦ã­ğŸ’–'); return; }
      idx = 0; renderQuestion();
      document.getElementById('start').closest('.card').style.display='none';
    };
    document.getElementById('prev').onclick = ()=>{ if(idx<=0) return; if(saveCurrent()){ idx--; renderQuestion(); }};
    document.getElementById('next').onclick = ()=>{
      if(!saveCurrent()) return;
      if(idx>=stepMax-1){ showResult(); return; }
      idx++; renderQuestion();
    };

    // å¾©å…ƒï¼ˆ?r=...ï¼‰
    (function restore(){
      const r = new URLSearchParams(location.search).get('r');
      if(!r) return;
      try{ const obj = JSON.parse(atob(r)); if(typeof obj.s==='number'){ document.getElementById('start').closest('.card').style.display='none'; idx=stepMax-1; renderQuestion(); showResult(); } }catch(e){}
    })();
  </script>

  <!-- =========================
  Google Apps Scriptï¼ˆç„¡æ–™ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ï¼šä»»æ„ï¼‰
  ========================== -->
  <!--
function doPost(e){
  try{
    var body = JSON.parse(e.postData.contents);
    var ss = SpreadsheetApp.openById('YOUR_SHEET_ID');
    var sh = ss.getSheetByName('responses') || ss.insertSheet('responses');
    if (sh.getLastRow() === 0){
      sh.appendRow(['ts','event','name','email','org','title','gender','age','score','level','href','ref','ua']);
    }
    var p = body.profile||{}; var r = body.result||{}; var m = body.meta||{};
    sh.appendRow([new Date(), body.event||'submit', p.name||'', p.email||'', p.org||'', p.title||'', p.gender||'', p.age||'', r.score||r.s, r.level||r.l, m.href||'', m.ref||'', m.ua||'']);
    return ContentService.createTextOutput(JSON.stringify({ok:true})).setMimeType(ContentService.MimeType.JSON);
  }catch(err){
    return ContentService.createTextOutput(JSON.stringify({ok:false,error:String(err)})).setMimeType(ContentService.MimeType.JSON);
  }
}
function doGet(){ return ContentService.createTextOutput('ok'); }
  -->
</body>
</html>
