<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>ã‚®ãƒ£ãƒ«ãƒã‚¤ãƒ³ãƒ‰è¨ºæ–­ï½œCGOãƒ‰ãƒƒãƒˆã‚³ãƒ </title>
  <meta name="description" content="ã‚®ãƒ£ãƒ«ãƒã‚¤ãƒ³ãƒ‰æŒ‡æ•°ï¼ˆè‡ªåˆ†è»¸ãƒ»ç›´è¦³æ€§ãƒ»ãƒã‚¸ãƒ†ã‚£ãƒ–æ€è€ƒï¼‰ã‚’æ¸¬ã‚‹è¨ºæ–­ã€‚1å•ãšã¤ãƒãƒ¼ãƒˆã§ã‚µã‚¯ã‚µã‚¯å›ç­”ã—ã¦ã€çµæœã¯10æ®µéšãƒ¬ãƒ™ãƒ«ã¨ç”»åƒã§è¡¨ç¤ºï¼">

<meta property="og:title" content="ã‚®ãƒ£ãƒ«ãƒã‚¤ãƒ³ãƒ‰è¨ºæ–­ğŸ’–">
<meta property="og:description" content="ã‚ãªãŸã®ã‚®ãƒ£ãƒ«ãƒã‚¤ãƒ³ãƒ‰æŒ‡æ•°ã‚’ãƒã‚§ãƒƒã‚¯ã—ã‚ˆğŸ’…âœ¨">
<meta property="og:type" content="website">
<meta property="og:url" content="https://garmin1016.github.io/galmind/">
<meta property="og:image" content="https://garmin1016.github.io/galmind/assets/result_level1.png">

<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="ã‚®ãƒ£ãƒ«ãƒã‚¤ãƒ³ãƒ‰è¨ºæ–­ğŸ’–">
<meta name="twitter:description" content="ã‚ãªãŸã®ã‚®ãƒ£ãƒ«ãƒã‚¤ãƒ³ãƒ‰æŒ‡æ•°ã‚’ãƒã‚§ãƒƒã‚¯ã—ã‚ˆğŸ’…âœ¨">
<meta name="twitter:image" content="https://garmin1016.github.io/galmind/assets/result_level1.png">

  
  <style>
    :root{
      --bg:#fff6fb;
      --card:#ffffff;
      --ink:#2a1a24;
      --muted:#7d6c78;
      --accentA:#ff76c3;
      --accentB:#a06bff;
      --ring:rgba(255,118,195,.5);
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      background: radial-gradient(1400px 80% at 70% -10%, #ffe9f7 0%, rgba(255,233,247,0) 60%),
                 radial-gradient(1200px 70% at 0% 100%, #efe5ff 0%, rgba(239,229,255,0) 60%), var(--bg);
      color:var(--ink);
      font-family: "Hiragino Kaku Gothic ProN", "Noto Sans JP", system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
      line-height:1.6;
    }
    /* Fixed header */
    .appbar{
      position:sticky; top:0; z-index:50; display:flex; align-items:center; gap:12px;
      padding:10px 16px; background:rgba(255,255,255,.7); backdrop-filter: blur(10px);
      border-bottom:1px solid #f7d6ee; box-shadow:0 6px 24px rgba(160,107,255,.08);
    }
    .logo{height:48px; width:auto}
    .brand{font-weight:800; letter-spacing:.02em; font-size:18px}
    .wrap{max-width:960px; margin:24px auto; padding:0 16px}
    .card{background:var(--card); border:1px solid #f7d6ee; border-radius:20px; padding:20px;
          box-shadow:0 20px 60px rgba(160,107,255,.08)}
    h1{margin:0 0 6px; font-size:26px}
    p.lead{margin:8px 0 18px; color:var(--muted)}
    /* progress */
    .progress{height:10px; background:#ffe0f2; border-radius:999px; overflow:hidden; border:1px solid #ffd1ec}
    .bar{height:100%; width:0%; background:linear-gradient(90deg, var(--accentA), var(--accentB));
         box-shadow:0 0 20px rgba(255,118,195,.5) inset}
    /* form */
    .grid{display:grid; grid-template-columns:1fr 1fr; gap:12px}
    .grid > div{display:flex; flex-direction:column; gap:6px}
    label{font-size:13px; color:var(--muted)}
    input, select{
      border:1.5px solid #f0d0ea; border-radius:12px; padding:12px 14px; outline:0;
      background:#fff; font-size:16px;
    }
    input:focus, select:focus{border-color:var(--accentA); box-shadow:0 0 0 4px var(--ring)}
    .btn{appearance:none; border:0; padding:12px 18px; border-radius:14px; color:#fff; font-weight:700;
         background:linear-gradient(180deg, var(--accentA), var(--accentB));
         box-shadow:0 10px 24px rgba(255,118,195,.35), 0 4px 12px rgba(160,107,255,.25);
         cursor:pointer}
    .btn:disabled{opacity:.6; cursor:not-allowed}
    .footer{margin:18px 0 0; color:var(--muted); font-size:12px; text-align:center}
    /* question card */
    .qcard{display:flex; flex-direction:column; gap:14px; padding:18px; border:1px solid #f7d6ee; border-radius:18px}
    .qnum{display:inline-flex; align-items:center; gap:8px; font-weight:800; color:#7f3da9}
    .qtext{font-size:18px; font-weight:700}
    .scale{display:flex; align-items:center; gap:10px; flex-wrap:wrap}
    .label-s{font-size:12px; color:var(--muted)}
    /* heart items */
    .heart{
      width:42px; height:42px; border-radius:12px; border:1.5px solid #ffd7ef;
      background:linear-gradient(180deg, #fff, #fff5fb);
      display:grid; place-items:center; cursor:pointer; transition:.12s;
      box-shadow:0 4px 10px rgba(160,107,255,.12);
    }
    .heart span{
      font-size:22px; filter: drop-shadow(0 1px 0 rgba(255,255,255,.9));
      background: -webkit-linear-gradient(45deg, var(--accentA), var(--accentB));
      -webkit-background-clip: text; -webkit-text-fill-color: transparent;
    }
    .heart[data-active="true"]{
      transform: translateY(-1px) scale(1.04);
      border-color:#ffb6e6;
      box-shadow:0 8px 18px rgba(255,118,195,.25), 0 3px 10px rgba(160,107,255,.2);
      background:linear-gradient(180deg, #fff, #ffe9f7);
    }
    .scale.large .heart{width:48px; height:48px}
    .scale.small .heart{width:36px; height:36px}
    .meaning{display:flex; gap:8px; justify-content:space-between; color:var(--muted); font-size:12px}
    .nav{display:flex; gap:10px; justify-content:flex-end}
    .hidden{display:none !important}
    /* result */
    .resultHead{display:flex; flex-direction:column; align-items:center; gap:8px; text-align:center}
    .score{
      font-size:42px; font-weight:900;
      background:linear-gradient(45deg, var(--accentA), var(--accentB));
      -webkit-background-clip:text; -webkit-text-fill-color:transparent;
      text-shadow:0 2px 0 rgba(255,255,255,.7);
    }
    .resultImg{width:100%; border-radius:16px; border:1px solid #f7d6ee; background:#fff}
    .share{display:flex; gap:10px; flex-wrap:wrap; justify-content:center}
    .sbtn{background:#fff; border:1.5px solid #f0d0ea; color:var(--ink); padding:10px 12px; border-radius:12px; cursor:pointer}
    .sbtn:hover{box-shadow:0 6px 14px rgba(160,107,255,.12)}
    @media (max-width: 720px){
      .grid{grid-template-columns:1fr}
      .logo{height:42px}
      .qtext{font-size:17px}
    }
  </style>
</head>
<body>
  <header class="appbar">
    <img src="assets/logo.png" alt="CGOãƒ‰ãƒƒãƒˆã‚³ãƒ " class="logo">
    <div class="brand">ã‚®ãƒ£ãƒ«ãƒã‚¤ãƒ³ãƒ‰è¨ºæ–­</div>
  </header>

  <main class="wrap">
    <section class="card" id="intro">
      <h1>ã‚®ãƒ£ãƒ«ãƒã‚¤ãƒ³ãƒ‰æŒ‡æ•°ã¨ã¯ï¼ŸğŸ’–</h1>
      <p class="lead">
        ã‚®ãƒ£ãƒ«ãƒã‚¤ãƒ³ãƒ‰æŒ‡æ•°ã¨ã¯ã€ä¼æ¥­ã«ãŠã‘ã‚‹ã‚ãªãŸã® <b>ã€Œè‡ªåˆ†è»¸ã€ğŸ’«ã€Œç›´è¦³æ€§ã€âœ¨ã€Œãƒã‚¸ãƒ†ã‚£ãƒ–æ€è€ƒã€ğŸŒˆ</b> ã®3ã¤ã®åŠ›ãŒã©ã‚Œãã‚‰ã„ç™ºæ®ã•ã‚Œã¦ã„ã‚‹ã‹ã‚’æ¸¬ã‚‹ã€åˆåŒä¼šç¤¾CGOãƒ‰ãƒƒãƒˆã‚³ãƒ ã®ç‹¬è‡ªæŒ‡æ¨™ã ã‚ˆã€‚
        è¨ºæ–­ã‚’å®šæœŸçš„ã«è¡Œã†ã“ã¨ã§è‡ªåˆ†ã®å¤‰åŒ–ã‚„æˆé•·åº¦ã‚’å¯è¦–åŒ–ã§ãã€ãƒãƒ¼ãƒ å…¨ä½“ã®ã‚®ãƒ£ãƒ«ãƒã‚¤ãƒ³ãƒ‰ã‚’æ•°å€¤åŒ–ã™ã‚‹ã“ã¨ã§ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³èª²é¡Œã®æ”¹å–„ã‚„ã‚¤ãƒãƒ™ãƒ¼ã‚·ãƒ§ãƒ³äººæã®è‚²æˆã«ã‚‚å½¹ç«‹ã¡ã¾ã™ã€‚
      </p>

      <div class="progress" aria-label="progress"><div class="bar" id="bar"></div></div>

      <div style="height:10px"></div>

      <div class="grid">
        <div>
          <label>ãŠåå‰</label>
          <input id="name" placeholder="ãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ ã§ã‚‚OK">
        </div>
        <div>
          <label>ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹</label>
          <input id="email" placeholder="example@company.jp">
        </div>

        <div>
          <label>æ‰€å±ï¼ˆä¼šç¤¾ãƒ»éƒ¨ç½²ãªã©ï¼‰</label>
          <input id="org" placeholder="CGOãƒ‰ãƒƒãƒˆã‚³ãƒ ">
        </div>
        <div>
          <label>å½¹è·</label>
          <input id="role" placeholder="ãƒ‡ã‚£ãƒ¬ã‚¯ã‚¿ãƒ¼ ãªã©">
        </div>

        <div>
          <label>æ€§åˆ¥</label>
          <select id="gender">
            <option value="">æœªé¸æŠ</option>
            <option>å¥³æ€§</option><option>ç”·æ€§</option><option>ãã®ä»–</option><option>å›ç­”ã—ãªã„</option>
          </select>
        </div>
        <div>
          <label>å¹´é½¢</label>
          <input id="age" placeholder="28 ãªã©">
        </div>
      </div>

      <div class="footer">
        å…¥åŠ›å¾Œã€ä¸‹ã®ãƒœã‚¿ãƒ³ã‹ã‚‰è¨ºæ–­ã‚’ã‚¹ã‚¿ãƒ¼ãƒˆã—ã¦ã­ğŸ’…
      </div>

      <div style="display:flex; justify-content:flex-end; margin-top:14px">
        <button class="btn" id="start">è¨ºæ–­ã‚¹ã‚¿ãƒ¼ãƒˆğŸ’–</button>
      </div>
    </section>

    <section class="card hidden" id="quiz">
      <div class="qcard">
        <div class="qnum"><span id="qnum">Q1</span><span class="label-s" id="counter">0/19</span></div>
        <div class="qtext" id="qtext">ã“ã“ã«è³ªå•ãŒè¡¨ç¤ºã•ã‚Œã¾ã™</div>
        <div class="meaning" id="meaningTop"></div>
        <div class="scale" id="scale"></div>
        <div class="meaning" id="meaningBtm"></div>
      </div>
      <div class="nav">
        <button class="sbtn" id="backBtn">æˆ»ã‚‹</button>
      </div>
    </section>

    <section class="card hidden" id="result">
      <div class="resultHead">
        <div class="score" id="scoreTxt">ã‚ãªãŸã®ã‚®ãƒ£ãƒ«ãƒã‚¤ãƒ³ãƒ‰æŒ‡æ•°ï¼š-- ç‚¹</div>
        <img id="resultImg" class="resultImg" alt="çµæœç”»åƒ">
      </div>
      <div style="height:10px"></div>
      <div class="share">
        <button class="sbtn" id="shareX">Xã§ã‚·ã‚§ã‚¢</button>
        <button class="sbtn" id="shareLINE">LINEã§ã‚·ã‚§ã‚¢</button>
        <button class="sbtn" id="copyLink">ãƒªãƒ³ã‚¯ã‚’ã‚³ãƒ”ãƒ¼</button>
      </div>
    </section>

  </main>
  
<script>
// === Google Sheets é€ä¿¡ç”¨ï¼ˆã‚ãªãŸã®GAS URLã‚’ãã®ã¾ã¾å…¥ã‚Œã‚‹ï¼‰ ===
const SHEET_ENDPOINT = 'https://script.google.com/macros/s/AKfycbwzrE23GIyyYh1iokhnogTfq83lhLmiS-06GDPBu_AfO9GbAEqjgAIPf4-SM0tm4BzYjQ/exec';
</script>
  
  <script>
    // ====== Data ======
    const QUESTIONS = [
      "ä¼šç¤¾ã®ä¸­ã§ã€Œã‚„ã£ã¦ã¿ãŸã„ğŸ’ã€ã¨æ€ã†ã“ã¨ãŒã‚ã‚‹ã€œã€œã€œï¼Ÿ",
      "ä»Šã‚„ã£ã¦ã„ã‚‹ä»•äº‹ã‚¹ã‚­ï¼Ÿâ˜…",
      "ä»Šã‚ˆã‚Šã‚‚ã£ã¨ğŸ‘†ã‚¢ã‚²ğŸ‘†ã«ãªã‚ŠãŸã„ï¼Ÿ",
      "ã€Œç§ãŒã‚„ã‚ŠãŸã„ä»•äº‹ã¯ã“ã‚Œãƒ€ãƒ¨â•ã€ã£ã¦è¨€ãˆã‚‹ï¼Ÿ",
      "ç¤¾å†…ã§ã€Œã“ã®äººã®è©±èã„ã¦ã¿ãŸã„â˜ºã€ã£ã¦æ€ã£ãŸã¨ãã«ã€ã™ãã«é€£çµ¡ã§ãã‚‹âœ‰ï¼Ÿ",
      "è‡ªåˆ†æœ€é«˜ã‚¸ãƒ£ãƒ³ã€œâ™¥ã£ã¦æ€ã†ï¼Ÿ",
      "ç¤¾å†…é£²ã¿ä¼šï¼ˆé£Ÿäº‹ä¼šï¼‰ã§ã€å‘¨ã‚Šã«åˆã‚ã›ãšã€è‡ªåˆ†ãŒå¥½ããªé£Ÿã¹ç‰©/é£²ã¿ç‰©ğŸ¥ƒã‚’é ¼ã‚ã‚‹ï¼Ÿ",
      "ã‚¹ãƒ†ã‚­ãªæ„è¦‹ã‚’è¨€ã£ãŸäººã«ã€Œã„ã„ã˜ã‚ƒã‚“ã€œğŸµã€ã£ã¦è¨€ãˆã‚‹ï¼Ÿ",
      "å¤šå°‘ç„¡ç†ãªã“ã¨ã§ã‚‚ã€Œã‚¦ãƒã‚‰ãªã‚‰ã§ãã‚‹ã£ã—ã‚‡ğŸ’ªã€ã£ã¦æ€ãˆã‚‹ï¼Ÿ",
      "è‡ªåˆ†ã‚ˆã‚Šã‚¨ãƒ©ã‚¤äººã«ã‚‚ã€è‡ªä¿¡ã‚’ã‚‚ã£ã¦æ„è¦‹ãŒè¨€ãˆã‚‹âœ¨ï¼Ÿ",
      "è‡ªåˆ†ã‚‰ã—ã„æœã‚„æŒã¡ç‰©ğŸ‘—ã‚’ä¼šç¤¾ã§ã‚‚èº«ã«ç€ã‘ã¦ã„ã‚‹ï¼Ÿ",
      "å¤šå°‘å‡¹ã‚“ã§ã‚‚ã€Œé€™ã„ä¸ŠãŒã‚‹ãğŸ’ªã€ã¨åŠ›ãŒæ¹§ã„ã¦ãã‚‹ã€œï¼Ÿ",
      "è‡ªåˆ†ã¨é•ã†æ„è¦‹ãŒå‡ºãŸã¨ãã€Œãã‚Œã¡ãŒããªã„ã€œï¼ŸğŸ’¦ã€ã£ã¦è¨€ãˆã‚‹ï¼Ÿ",
      "ã„ã‚„ãªã“ã¨ã«ã¯ã™ã‹ã•ãšã€ŒNOâ•â•â•ã€ã£ã¦è¨€ãˆã‚‹ï¼Ÿ",
      "è‡ªåˆ†ã¯ãªã«ã‹æˆã—é‚ã’ã‚‰ã‚Œã¡ã‚ƒã†ã‹ã‚‚ğŸŒã¨æ€ã£ã¦ã‚‹ã€œï¼Ÿ",
      "è‡ªåˆ†ã®ã€Œã“ã‚Œã ã‘ã¯è­²ã‚Œãªã„ãƒƒâ£ã€ã£ã¦ãƒ¢ãƒ/ã‚³ãƒˆã£ã¦ã‚ã‚‹ã€œï¼Ÿ",
      "è€ƒãˆã‚‹ã‚ˆã‚Šä½“å‹•ã„ã¡ã‚ƒã†ã€œã€œã€œã€œã€œï¼ŸğŸ’ƒ",
      "è‡ªåˆ†ã®ã‚¹ã‚­ğŸ’ãªã¨ã“ã‚ï¼“ã¤ä»¥ä¸Šã„ãˆã‚‹ã€œï¼Ÿ",
      "è‡ªåˆ†ã®å¿ƒã«ã¯ã€Œè‡ªåˆ†è»¸ãƒ»ç›´æ„Ÿæ€§ãƒ»ãƒã‚¸ãƒ†ã‚£ãƒ–æ€è€ƒã€ãŒã‚ã‚‹ã€œã€œã€œï¼Ÿ"
    ];
    const MEANINGS_5 = ["å…¨ãæ€ã‚ãªã„ğŸ˜®â€ğŸ’¨","ã‚ã‚“ã¾æ€ã‚ãªã„ğŸ’­","ã©ã¡ã‚‰ã¨ã‚‚ğŸ¤”","ãã†æ€ã†ã‹ã‚‚ğŸ’¡","ã‚ã£ã¡ã‚ƒæ€ã†ğŸ’—"];
    const MEANINGS_10_LEFT = "å…¨ãæ€ã‚ãªã„ğŸ˜®â€ğŸ’¨";
    const MEANINGS_10_RIGHT = "è¶…ã‚ã‹ã‚‹ã€œï¼ğŸ’—";

    // ====== State ======
    let idx = -1; // start before first
    const answers = {}; // 1-based index
    const bar = document.getElementById('bar');

    // ====== Elements ======
    const elIntro = document.getElementById('intro');
    const elQuiz  = document.getElementById('quiz');
    const elRes   = document.getElementById('result');
    const qnum = document.getElementById('qnum');
    const counter = document.getElementById('counter');
    const qtext = document.getElementById('qtext');
    const scale = document.getElementById('scale');
    const meaningTop = document.getElementById('meaningTop');
    const meaningBtm = document.getElementById('meaningBtm');

    function updateProgress(n){
      const pct = Math.round((n)/19*100);
      bar.style.width = pct + '%';
    }

    function makeHeart(val, active=false, size=""){
      const b = document.createElement('button');
      b.className = 'heart';
      if(size==="large") b.classList.add('large');
      b.dataset.val = String(val);
      b.dataset.active = active ? "true":"false";
      const span = document.createElement('span');
      span.textContent = "ğŸ’—";
      b.appendChild(span);
      b.addEventListener('click', ()=>{
        saveAnswer(val);
      });
      return b;
    }

    function renderQuestion(){
      const n = idx + 1;
      qnum.textContent = "Q"+n;
      counter.textContent = n + "/19";
      qtext.textContent = QUESTIONS[idx];
      scale.innerHTML = "";
      meaningTop.innerHTML = ""; meaningBtm.innerHTML = "";

      // hearts
      if(n===19){
        scale.className = 'scale large';
        meaningTop.textContent = MEANINGS_10_LEFT;
        meaningBtm.style.justifyContent = 'flex-end';
        meaningBtm.textContent = MEANINGS_10_RIGHT;
        for(let i=1;i<=10;i++){
          const h = makeHeart(i, answers[n] && i<=answers[n] , i>=8? "large" : (i<=3? "small": ""));
          scale.appendChild(h);
        }
      }else{
        scale.className = 'scale';
        // meaning line
        const left = document.createElement('div'); left.textContent = MEANINGS_5[0];
        const right = document.createElement('div'); right.textContent = MEANINGS_5[4];
        meaningTop.appendChild(left); meaningTop.appendChild(right);
        meaningTop.style.justifyContent = 'space-between';

        for(let i=1;i<=5;i++){
          const size = (i===5? "large" : (i===1? "small": ""));
          const h = makeHeart(i, answers[n] && i<=answers[n], size);
          scale.appendChild(h);
        }
      }
      updateProgress(idx);
    }

    function saveAnswer(val){
      const n = idx+1;
      answers[n] = val;
      // auto advance or show result
      if(n>=19){ showResult(); }
      else { idx++; renderQuestion(); }
    }

    function calcScore(){
      let s = 0;
      for(let i=1;i<=18;i++){ s += Number(answers[i] || 0); }
      s += Number(answers[19] || 0);
      return Math.max(0, Math.min(100, s));
    }

    function levelFromScore(s){
      if(s>=95) return 10;
      if(s>=90) return 9;
      if(s>=80) return 8;
      if(s>=70) return 7;
      if(s>=60) return 6;
      if(s>=50) return 5;
      if(s>=40) return 4;
      if(s>=30) return 3;
      if(s>=20) return 2;
      return 1;
    }

    function showResult(){
      const score = calcScore();
      const lv = levelFromScore(score);
      // store
      try{
        const profile = {
          name: document.getElementById('name').value.trim(),
          email: document.getElementById('email').value.trim(),
          org: document.getElementById('org').value.trim(),
          role: document.getElementById('role').value.trim(),
          gender: document.getElementById('gender').value,
          age: document.getElementById('age').value.trim(),
          answers, score, lv, ts: Date.now()
        };
        localStorage.setItem('galmind_latest', JSON.stringify(profile));
        // ä¾‹ï¼‰localStorage ä¿å­˜ã®ã™ãä¸‹ã«è¿½è¨˜ã™ã‚‹
const payload = {
  name: profile.name,
  email: profile.email,
  org: profile.org,
  role: profile.role,
  gender: profile.gender,
  age: profile.age,
  score: score,        // â† showResult() ã§è¨ˆç®—æ¸ˆã¿ã®å€¤ã‚’ä½¿ã†
  level: lv,           // â† showResult() ã§å‡ºã—ãŸãƒ¬ãƒ™ãƒ«
  answers: answers,    // 19å•ã®å›ç­”ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ
  ua: navigator.userAgent,
  page: location.href.split('?')[0],
  referrer: document.referrer
};
sendToSheet(payload);
        
      }catch(e){}

      // UI
      document.getElementById('scoreTxt').textContent = `ã‚ãªãŸã®ã‚®ãƒ£ãƒ«ãƒã‚¤ãƒ³ãƒ‰æŒ‡æ•°ï¼š${score} ç‚¹`;
      const img = document.getElementById('resultImg');
      img.src = `assets/result_level${lv}.png`;
      // OGPç”»åƒã‚‚åŒã˜ã‚‚ã®ã«åˆ‡ã‚Šæ›¿ãˆã‚‹
document.querySelector('meta[property="og:image"]')
  ?.setAttribute("content", `https://garmin1016.github.io/galmind/assets/result_level${lv}.png`);

document.querySelector('meta[name="twitter:image"]')
  ?.setAttribute("content", `https://garmin1016.github.io/galmind/assets/result_level${lv}.png`);

      img.alt = `ãƒ¬ãƒ™ãƒ«${lv}ã®çµæœç”»åƒ`;

      elQuiz.classList.add('hidden');
      elIntro.classList.add('hidden');
      elRes.classList.remove('hidden');

      // share handlers
      const url = new URL(location.href);
      url.searchParams.set('s', String(score));
      url.searchParams.set('lv', String(lv));
      const shareText = `ã‚®ãƒ£ãƒ«ãƒã‚¤ãƒ³ãƒ‰æŒ‡æ•°ã¯ ${score} ç‚¹ï¼ˆLv${lv}ï¼‰ã§ã—ãŸğŸ’– #ã‚®ãƒ£ãƒ«ãƒã‚¤ãƒ³ãƒ‰è¨ºæ–­`;

      document.getElementById('shareX').onclick = ()=>{
        const tw = new URL('https://twitter.com/intent/tweet');
        tw.searchParams.set('text', shareText);
        tw.searchParams.set('url', url.toString());
        window.open(tw.toString(), '_blank');
      };
      document.getElementById('shareLINE').onclick = ()=>{
        const ln = new URL('https://social-plugins.line.me/lineit/share');
        ln.searchParams.set('url', url.toString());
        window.open(ln.toString(), '_blank');
      };
      document.getElementById('copyLink').onclick = async ()=>{
        try{ await navigator.clipboard.writeText(url.toString()); alert('ãƒªãƒ³ã‚¯ã‚’ã‚³ãƒ”ãƒ¼ã—ãŸã‚ˆğŸ’…'); }
        catch(e){ prompt('ã“ã®ãƒªãƒ³ã‚¯ã‚’ã‚³ãƒ”ãƒ¼ã—ã¦ã­', url.toString()); }
      };
      updateProgress(19);
    }

    // Start
    document.getElementById('start').addEventListener('click', ()=>{
      const name = document.getElementById('name').value.trim();
      const email = document.getElementById('email').value.trim();
      if(!name || !email){ alert('ãŠåå‰ã¨ãƒ¡ãƒ¼ãƒ«ã ã‘å…¥ã‚Œã¦ã­ğŸ’–'); return; }
      idx = 0;
      elIntro.classList.add('hidden');
      elQuiz.classList.remove('hidden');
      renderQuestion();
    });

    document.getElementById('backBtn').addEventListener('click', ()=>{
      if(idx<=0) { elQuiz.classList.add('hidden'); elIntro.classList.remove('hidden'); updateProgress(0); return; }
      idx--; renderQuestion();
    });

    // restore if URL param exists
    (function(){
      const sp = new URLSearchParams(location.search);
      const restoredScore = Number(sp.get('s') || 'NaN');
      if(!Number.isNaN(restoredScore)){
        // show level image directly
        const lv = levelFromScore(restoredScore);
        document.getElementById('scoreTxt').textContent = `ã‚ãªãŸã®ã‚®ãƒ£ãƒ«ãƒã‚¤ãƒ³ãƒ‰æŒ‡æ•°ï¼š${restoredScore} ç‚¹`;
        document.getElementById('resultImg').src = `assets/result_level${lv}.png`;
        elIntro.classList.add('hidden'); elQuiz.classList.add('hidden'); elRes.classList.remove('hidden');
        updateProgress(19);
     }
    })();
  </script>

<script>
async function sendToSheet(payload){
  try{
    await fetch(SHEET_ENDPOINT, {
      method: 'POST',
      mode: 'no-cors',                        // â† ãƒ—ãƒªãƒ•ãƒ©ã‚¤ãƒˆå›é¿ï¼ˆGASç”¨ï¼‰
      headers: { 'Content-Type': 'text/plain' },
      body: JSON.stringify(payload)
    });
    return true;
  }catch(e){
    return false;
  }
}
</script>

</body>
</html>

